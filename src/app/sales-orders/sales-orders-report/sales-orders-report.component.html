<div class="feature-header">
  <p>
    <label>Ordene seu relatório.</label>
  </p>
  <div class="actions">
    <app-button-back fallbackURL="/sales-orders"></app-button-back>
  </div>
</div>
<p-card>
  <form [formGroup]="formFields" (ngSubmit)="submitReport()">
    <div class="p-fluid p-formgrid p-grid">
      <div class="orderForm">
        <label class="marginHorizontal">Periodo: De</label>
        <p-inputMask mask="99/99/9999" formControlName="initialDate"></p-inputMask>
        <p class="marginHorizontal">Até</p>
        <p-inputMask mask="99/99/9999" formControlName="finalDate"></p-inputMask>
      </div>
      <div class="orderForm">
        <label class="marginHorizontal">Agrupar Por:</label>
        <p-dropdown
          [options]="groupBy"
          placeholder="Selecione a forma de Agrupamento"
          [showClear]="true"
          formControlName="groupBy"
        ></p-dropdown>
      </div>
      <div class="orderForm">
        <button pButton type="button" class="ui-button-primary" label="Agrupar" (click)="submitReport()"></button>
      </div>
    </div>
  </form>
</p-card>

<dgz-table #salesOrdersTable [dataProvider]="this" name="sales-orders-list" *ngIf="!loading">
  <thead>
    <tr>
      <th>Nome</th>
      <th>Email</th>
      <th>Telefone</th>
      <th>Total</th>
      <th>Detalhes</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let salesOrder of salesOrdersTable.currentData">
      <td class="centered">{{ salesOrder.creationDate | date: 'dd/MM HH:mm' }}</td>
      <td class="centered">{{ salesOrder.referenceCode }}</td>
      <td>{{ salesOrder.customer.name }}</td>
      <td class="currency">{{ salesOrder.total | reais }}</td>
      <td class="centered">
        <a [title]="'Venda'" [routerLink]="'/sales-orders/' + salesOrder.referenceCode">
          <button
            pButton
            type="button"
            class="ui-button-secondary"
            [icon]="'fal fa-search'"
            [pTooltip]="'Visualizar venda.'"
            tooltipPosition="top"
          ></button>
        </a>
      </td>
    </tr>
  </tbody>
</dgz-table>
<ng-container *ngIf="loading">
  <div class="dgz-table dgz-table-info">
    <i class="fal fa-exclamation-circle"></i>
    <p>Selecione como deseja agrupar o relátorio.</p>
  </div>
</ng-container>
